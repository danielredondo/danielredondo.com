---
title: "Coloreando atractores"
draft: yes
date: '2019-01-29'
---



<pre class="r"><code># Sólo para Mac:
system(&quot;say -v Jorge He acabado el primer gráfico&quot;)

library(Rcpp)
library(tidyverse)
library(wesanderson)
library(colorspace)

opt &lt;-  theme(legend.position  = &quot;none&quot;,
              panel.background = element_rect(fill = &quot;white&quot;),
              plot.background  = element_rect(fill = &quot;white&quot;),
              axis.ticks       = element_blank(),
              panel.grid       = element_blank(),
              axis.title       = element_blank(),
              axis.text        = element_blank())

cppFunction(&#39;DataFrame createTrajectory(int n, double x0, double y0, 
            double a1,  double a2,  double a3,  double a4,  double a5,  double a6,  double a7,
            double a8,  double a9,  double a10, double a11, double a12, double a13, double a14) {
            // create the columns
            NumericVector x(n);
            NumericVector y(n);
            x[0] = x0;
            y[0] = y0;
            for(int i = 1; i &lt; n; ++i) {
            x[i] = a1 + a2 * x[i-1] + a3  * y[i-1] + a4  * pow(fabs(x[i-1]), a5)  + a6  * pow(fabs(y[i-1]), a7 );
            y[i] = a8 + a9 * x[i-1] + a10 * y[i-1] + a11 * pow(fabs(x[i-1]), a12) + a13 * pow(fabs(y[i-1]), a14);
            }
            // return a new data frame
            return DataFrame::create(_[&quot;x&quot;]= x, _[&quot;y&quot;]= y);
            }
            &#39;)

a1 &lt;- -0.8
a2 &lt;- 0.4
a3 &lt;- -1.1
a4 &lt;- 0.5
a5 &lt;- -0.6
a6 &lt;- -0.1
a7 &lt;- -0.5
a8 &lt;- 0.8
a9 &lt;- 1.0
a10 &lt;- -0.3
a11 &lt;- -0.6
a12 &lt;- -0.3
a13 &lt;- -1.2
a14 &lt;- -0.3

df &lt;- createTrajectory(10000000, 1, 1, a1, a2, a3, a4, a5, a6, 
                       a7, a8, a9, a10, a11, a12, a13, a14)

mx &lt;- quantile(df$x, probs = 0.01)
Mx &lt;- quantile(df$x, probs = 0.99)
my &lt;- quantile(df$y, probs = 0.05)
My &lt;- quantile(df$y, probs = 0.95)

df %&gt;% filter(x &gt; mx, x &lt; Mx, y &gt; my, y &lt; My) -&gt; df

# GRAFICO ORIGINAL
plot &lt;- ggplot(df) +
  geom_point(aes(x, y), shape = 46, alpha = 0.01, size = 0, color = &quot;black&quot;) +
  scale_x_continuous(expand = c(0,0))+
  scale_y_continuous(expand = c(0,0))+
  coord_fixed() + 
  opt

ggsave(&quot;original.png&quot;, plot, height = 4, width = 8, units = &#39;in&#39;, dpi = 1200)</code></pre>
<div class="figure">
<img src="https://i.imgur.com/kDhBiiU.jpg" />

</div>
<pre class="r"><code># EJEMPLO 1
df$s &lt;- (df$x - mean(df$x))^2 + (df$y-mean(df$y))^2 + 4*rnorm(nrow(df))
df &lt;- df[order(df$s), ]

plot &lt;- ggplot(df) +
  geom_point(aes(x, y), shape = 46, alpha = 0.01, size = 0, color = rainbow(nrow(df))) +
  scale_x_continuous(expand = c(0,0))+
  scale_y_continuous(expand = c(0,0))+
  coord_fixed() + 
  opt

ggsave(&quot;rainbow.png&quot;, plot, height = 4, width = 8, units = &#39;in&#39;, dpi = 1200)</code></pre>
<div class="figure">
<img src="https://i.imgur.com/tmLflBp.jpg" />

</div>
<pre class="r"><code># EJEMPLO 2
a1 &lt;- -0.8
a2 &lt;- 0.5
a3 &lt;- -0.9
a4 &lt;- 0.4
a5 &lt;- -0.6
a6 &lt;- -0.5
a7 &lt;- -0.2
a8 &lt;- 0.8
a9 &lt;- 1.0
a10 &lt;- -0.3
a11 &lt;- -0.4
a12 &lt;- -0.2
a13 &lt;- -1.2
a14 &lt;- -0.3

df &lt;- createTrajectory(10000000, 1, 1, a1, a2, a3, a4, a5, a6, 
                       a7, a8, a9, a10, a11, a12, a13, a14)

mx &lt;- quantile(df$x, probs = 0.01)
Mx &lt;- quantile(df$x, probs = 0.99)
my &lt;- quantile(df$y, probs = 0.05)
My &lt;- quantile(df$y, probs = 0.95)

df %&gt;% filter(x &gt; mx, x &lt; Mx, y &gt; my, y &lt; My) -&gt; df

df$s &lt;- df$y + 4 * rnorm(nrow(df))
df &lt;- df[order(df$s), ]

pal &lt;- diverging_hcl(nrow(df), &quot;Blue-Red 2&quot;)

plot &lt;- ggplot(df) +
  geom_point(aes(x, y), shape = 46, alpha = 0.01, size = 0, color = pal) +
  scale_x_continuous(expand = c(0,0))+
  scale_y_continuous(expand = c(0,0))+
  coord_fixed() + 
  opt

ggsave(&quot;hcl.png&quot;, plot, height = 4, width = 8, units = &#39;in&#39;, dpi = 1200)</code></pre>
<div class="figure">
<img src="https://i.imgur.com/QmeLheS.jpg" />

</div>
<pre class="r"><code># EJEMPLO 3
a1 &lt;- -1.0
a2 &lt;- 0.4
a3 &lt;- -1.1
a4 &lt;- 0.5
a5 &lt;- -0.6
a6 &lt;- -0.1
a7 &lt;- -0.5
a8 &lt;- 0.8
a9 &lt;- 1.0
a10 &lt;- -0.3
a11 &lt;- -0.6
a12 &lt;- -0.3
a13 &lt;- -1.2
a14 &lt;- -0.3

df &lt;- createTrajectory(10000000, 1, 1, a1, a2, a3, a4, a5, a6, 
                       a7, a8, a9, a10, a11, a12, a13, a14)

mx &lt;- quantile(df$x, probs = 0.01)
Mx &lt;- quantile(df$x, probs = 0.99)
my &lt;- quantile(df$y, probs = 0.05)
My &lt;- quantile(df$y, probs = 0.95)

df %&gt;% filter(x &gt; mx, x &lt; Mx, y &gt; my, y &lt; My) -&gt; df

df$s &lt;- df$y + rnorm(nrow(df))/5

df &lt;- df[order(df$s), ]

pal &lt;- wes_palette(nrow(df), name = &quot;GrandBudapest1&quot;, type = &quot;continuous&quot;)

plot &lt;- ggplot(df) +
  geom_point(aes(x, y), shape = 46, alpha = 0.01, size = 0, color = pal) +
  scale_x_continuous(expand = c(0,0))+
  scale_y_continuous(expand = c(0,0))+
  coord_fixed() + 
  opt

ggsave(&quot;wes.png&quot;, plot, height = 4, width = 8, units = &#39;in&#39;, dpi = 1200)</code></pre>
<div class="figure">
<img src="https://i.imgur.com/bZVbB3s.jpg" />

</div>
