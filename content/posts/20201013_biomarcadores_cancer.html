---
title: "Detección de biomarcadores en cáncer"
date: '2020-10-06'
draft: yes
tags:
- dataviz
- shiny
- machine learning
- cancer
---



<p>Tras acabar el Máster de Ciencia de Datos, quiero compartir en esta web un resumen de mi Trabajo Fin de Máster. Está titulado “Epidemiología y detección de biomarcadores en cáncer” y ha sido tutorizado por Daniel Castillo Secilla y Luis Javier Herrera. Estoy además muy orgulloso porque ha sido evaluado con un 10.</p>
<p>El código del análisis (R), el documento (LaTeX + PDF) y la presentación de la defensa (PDF) están disponibles en <a href="https://github.com/danielredondo/TFM_ciencia_de_datos">GitHub</a>.<!--more--></p>
<p>Tras acabar el Máster de Ciencia de Datos, quiero compartir en esta web un resumen de mi Trabajo Fin de Máster. Está titulado “Epidemiología y detección de biomarcadores en cáncer” y ha sido tutorizado por Daniel Castillo Secilla y Luis Javier Herrera. Estoy además muy orgulloso porque ha sido evaluado con un 10.</p>
<p>El código del análisis (R), el documento (LaTeX + PDF) y la presentación de la defensa (PDF) están disponibles en <a href="https://github.com/danielredondo/TFM_ciencia_de_datos">GitHub</a>.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva1.png" /></p>
<div id="introducción" class="section level2">
<h2>Introducción</h2>
<p>El trabajo se centra en el cáncer de colon-recto y en el cáncer de hígado, dos cánceres muy frecuentes y con alta mortalidad.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva4.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva6.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva7.png" /></p>
</div>
<div id="metodología" class="section level2">
<h2>Metodología</h2>
<p>Los datos provienen de GDC Portal y son de acceso abierto. Se realiza una partición entrenamiento (75%) - test (25%) de los datos con equilibrio de clases. Se realiza validación cruzada 5-fold con 3 métodos de selección de características (mRMR, random forest y DA) y 3 algoritmos de clasificación (máquinas de soporte vectorial, random forest y kNN).</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva9.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva10.png" /></p>
<p>El código es abierto y reproducible: se ha utilizado R con varios paquetes del tidyverse (para preprocesamiento, ingeniería de datos y visualización), KnowSeq (para machine learning con datos transcriptómicos) y Shiny (para desarrollar una aplicación web).</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva12.png" />
## Resultados</p>
<p>El análisis biclase (tejido tumoral vs tejido sano) lo ilustro con el cáncer de colon-recto. En los datos hay desequilibrio de clases (~13 tejidos tumorales por cada tejido sano) así que se utiliza F1-Score como medida de evaluación.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva15.png" /></p>
<p>Para cada método de selección de características (mRMR, random forest y DA) se calcula el ranking de los 10 genes más relevantes.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva16.png" /></p>
<p>Con estos genes se procede a entrenar modelos de clasificación usando SVM, random forest y kNN con optimización de parámetros. Por ejemplo, para random forest el mejor F1 se obtiene para 4 genes seleccionados mediante mRMR.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva17.png" /></p>
<p>Con un simple diagrama de cajas y bigotes se puede observar que la expresión de estos 4 genes varía en función del tipo de tejido (tejido tumoral en rojo, tejido normal en verde).</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva18.png" /></p>
<p>Para el análisis biclase de colon-recto, los tres algoritmos de clasificación distinguen perfectamente entre tumor y tejido sano usando menos de 5 genes. F1-Score: 100% en entrenamiento, 100% en test.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva19.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva20.png" /></p>
<p>Proceso análogo para el análisis multiclase en cáncer de hígado (distintos tipos de tumor vs. tejido sano). Los mejores modelos separan tejidos tumorales de tejidos sanos, aunque tienen dificultad en distinguir los distintos tipos de tumor. F1: 95% en entrenamiento, 92% en test.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva21.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva24.png" /></p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva25.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva26.png" /></p>
<p>He desarrollado una aplicación web interactiva de código abierto para que usuarios sin conocimientos previos de programación puedan realizar los análisis anteriores de forma interactiva. Está disponible en <a href="https://dredondo.shinyapps.io/biomarkeRs/">este enlace</a>.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva27.png" /></p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva28.png" /></p>
</div>
<div id="conclusiones" class="section level2">
<h2>Conclusiones</h2>
<p>Resumiendo las conclusiones: 1) Los modelos que usan pocos genes tienen muchas ventajas (bajo coste, interpretabilidad, …) y 2) Cuando los modelos son efectivos, se puede lograr un aumento del diagnóstico temprano que se acaba traduciendo en una mejora del pronóstico.</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva30.png" />
<img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva31.png" /></p>
<p>Las líneas abiertas del trabajo se centran en encontrar mejores modelos (p.ej. usando ensembles, o realizando análisis complementarios) y en seguir mejorando #KnowSeq y la aplicación web (de código abierto).</p>
<p><img src="/img/2020/20201013_biomarcadores_cancer/Diapositiva33.png" /></p>
<p>¡Y eso es todo! Muchas gracias si has llegado hasta aquí. Recordaros que el documento, así como el código desarrollado y la presentación, está disponible en GitHub: <a href="https://github.com/danielredondo/TFM_ciencia_de_datos">https://github.com/danielredondo/TFM_ciencia_de_datos</a></p>
</div>
